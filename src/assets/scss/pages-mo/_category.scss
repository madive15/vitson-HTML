// -----------------------------------------------------------------------------
// pages-mo/_category.scss
// - 모바일 카테고리 상품목록 페이지 레이아웃 스타일
// - .vm-category-sheet: 카테고리 바텀시트 내부 2-패널 레이아웃
// -----------------------------------------------------------------------------

@use 'sass:map';
@use '@/assets/scss/abstracts/variables' as var;
@use '@/assets/scss/abstracts/mixins' as mx;
@use '@/assets/scss/abstracts/functions' as fn;
@use '@/assets/scss/base/colors' as color;
@use '@/assets/scss/base/typography' as typo;
@use '@/assets/scss/components/icon' as icon;
@use '@/assets/scss/components/button' as button;

$active-color: map.get(color.$text-status, 'brand');

.main-content-category {
  @include mx.flex(flex, column);
  gap: map.get(var.$unit, 8);
}

// 켄도윈도우: 카테고리 시트용 오버라이드
.vm-modal-content:has(.vm-category-sheet) {
  display: flex;
  flex-direction: column;
  padding: 0;
  overflow: hidden; // 패널 각각 독립 스크롤
}

// 카테고리 바텀시트
.vm-category-sheet {
  display: flex;
  flex: 1;
  flex-direction: column;
  min-height: 0;
  overflow: hidden;

  .sheet-body {
    display: flex;
    flex: 1;
    min-height: 0;
    overflow: hidden;
  }

  // 좌측: depth1
  .depth1 {
    &-panel {
      flex-shrink: 0;
      width: 43.33%;
      overflow: hidden auto;
      overscroll-behavior: contain;
      background: map.get(color.$layout-surf, 'mypage');
      -webkit-overflow-scrolling: touch;
    }

    &-item {
      @include typo.typography('b3r', $color: map.get(color.$text-colors, 'secondary'));
      padding: map.get(var.$unit, 20) map.get(var.$unit, 16);
      cursor: pointer;

      // 탐색 중 (좌측 클릭 시)
      &.is-current {
        font-weight: 600;
        color: map.get(color.$text-colors, 'primary');
        background: map.get(color.$layout-surf, 'base');
      }

      // 확정 선택 — is-current가 다른 곳에 있으면 기본으로 복귀
      &.is-active:not(.is-current) {
        font-weight: inherit;
        color: inherit;
        background: transparent;
      }

      // 확정 + 탐색 동일 항목
      &.is-active.is-current {
        font-weight: 600;
        color: map.get(color.$text-colors, 'primary');
        background: map.get(color.$layout-surf, 'base');
      }
    }
  }

  // 우측: depth2/3
  .depth-sub-panel {
    flex: 1;
    min-width: 0;
    overflow: hidden auto;
    overscroll-behavior: contain;
    -webkit-overflow-scrolling: touch;
  }

  .depth-sub-list {
    @include mx.flex(flex, column);
    gap: map.get(var.$unit, 4);
    min-height: 0;
    padding: map.get(var.$unit, 8) map.get(var.$unit, 16) map.get(var.$unit, 8) map.get(var.$unit, 12);
  }

  // 전체보기
  .view-all {
    .text {
      @include button.btn-reset;
      @include typo.typography('b3s');
      display: block;
      width: 100%;
      padding: fn.rem(14) map.get(var.$unit, 4);
      text-align: left;
    }

    &.is-active .text {
      color: $active-color;
    }
  }

  // depth2
  .depth2 {
    &-header {
      @include mx.flex(flex, row, space-between, center);
      gap: map.get(var.$unit, 8);
      padding: 0 map.get(var.$unit, 4);
      text-align: left;

      .text {
        @include button.btn-reset;
        @include typo.typography('b3s');
        flex: 1;
        min-width: 0;
        padding: fn.rem(14) 0;
        text-align: left;
      }

      .toggle-btn {
        @include button.btn-reset;
        @include icon.ic-size(map.get(var.$unit, 16));
        box-sizing: content-box;
        flex-shrink: 0;
        padding: map.get(var.$unit, 8);
        margin: (map.get(var.$unit, 8) * -1);
        transition: transform 0.3s;
        transform: rotate(90deg);
      }
    }

    &-item {
      @include mx.flex(flex, column);
      gap: map.get(var.$unit, 4);

      // 아코디언 열림
      &.is-open {
        padding-bottom: map.get(var.$unit, 8);

        .toggle-btn {
          transform: rotate(0deg);
        }
      }

      // depth2 선택 상태 — depth3에 활성 항목 없을 때만
      &.is-active:not(:has(.depth3-item.is-active)) > .depth2-header .text {
        color: $active-color;
      }
    }
  }

  // depth3
  .depth3 {
    &-list {
      @include mx.flex(flex, column);
      gap: map.get(var.$unit, 2);
    }

    &-item {
      @include typo.typography('b4r', $color: map.get(color.$text-colors, 'secondary'));
      padding: map.get(var.$unit, 8) map.get(var.$unit, 4);

      &.is-active {
        color: $active-color;
      }
    }
  }
}
