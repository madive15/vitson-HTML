// -----------------------------------------------------------------------------
// layout/_header.scss
// - 헤더 내부 UI 전용. 레이아웃(높이/배치)은 layout/_wrapper.scss에서만 제어.
// -----------------------------------------------------------------------------

@use 'sass:map';
@use '@/assets/scss/abstracts/variables' as var;
@use '@/assets/scss/abstracts/mixins' as mx;
@use '@/assets/scss/abstracts/functions' as fn;
@use '@/assets/scss/base/colors' as color;
@use '@/assets/scss/base/typography' as typo;
@use '@/assets/scss/components/icon' as icon;
@use '@/assets/scss/components/button' as button;
@use '@/assets/scss/pages/mypage' as mypage;

$header-rank-height: fn.rem(24);
$header-rank-bar-height: fn.rem(18);
$header-search-input: fn.rem(380);
$header-search-panel: fn.rem(460);
$header-search-width: fn.rem(460);
$header-gnb-more-height: fn.rem(28);

@mixin gnb-btn-active-style {
  .icon {
    color: map.get(color.$brand-colors, 'primary');
  }

  .text {
    color: map.get(color.$brand-colors, 'primary');
  }
}

@mixin header-common-relative($type: null) {
  position: relative;

  @if $type != 'main' {
    z-index: var.$zindex-base;
  }
  // stylelint-disable-next-line at-rule-empty-line-before
  @else {
    z-index: var.$zindex-base + 1;
  }
  background: color.$color-white;
}

@mixin gnb-category-link {
  background: map.get(color.$layout-status, 'info-bg-sub');

  .text {
    font-weight: 700;
    color: map.get(color.$text-status, 'info-sub');
  }

  &:has(> .icon) {
    padding-right: map.get(var.$unit, 24);
  }
}

.vits-header {
  @include mx.border($color: map.get(color.$layout-border, 'quaternary'));
  position: relative;
  z-index: var.$zindex-base + 1;
  background: color.$color-white;

  &-topbar {
    @include header-common-relative;
    @include mx.flex(flex, row, flex-start, center);
    @include mx.border($color: map.get(color.$gray-shades, '30'));
    height: var.$header-topbar-height;

    .vits-inner {
      @include mx.flex(flex, row, space-between, center);
    }

    .header-topbar {
      &-right {
        @include mx.divider($h: 8);

        &-spacer {
          a + a {
            margin-left: map.get(var.$unit, 24);
          }
        }
      }
    }
  }

  &-main {
    @include header-common-relative('main');
    @include mx.flex(flex, row, flex-start, center);
    height: var.$header-main-height;

    .vits-inner {
      @include mx.flex(flex, row, space-between, center);
      height: 100%;
      padding-top: map.get(var.$unit, 16);
      padding-bottom: map.get(var.$unit, 16);

      @media screen and (width >= 1280px) and (width <= 1320px) {
        padding-right: map.get(var.$unit, 24);
      }
    }

    .header-rank {
      &-bar {
        @include mx.flex(flex, row, flex-start, center);
        gap: map.get(var.$unit, 8);
        height: $header-rank-bar-height;
      }

      &-link {
        @include mx.flex(inline-flex, row, flex-start, center);
        min-width: 0;
        margin-right: auto;
      }

      &-track {
        display: block;
        transition: transform 0.6s ease;
        transform: translateY(0);
        will-change: transform;
      }

      &-view {
        display: block;
        width: 100%;
        height: $header-rank-height;
        overflow: hidden;

        &.is-rolling .header-rank-track {
          transform: translateY(-#{$header-rank-height});
        }
      }

      &-row {
        @include mx.flex(flex, row, flex-start, center);
        gap: map.get(var.$unit, 8);
        height: $header-rank-height;
        line-height: $header-rank-height;
      }

      &-num {
        @include typo.typography('b3sb', $color: map.get(color.$brand-colors, 'primary'));
      }

      &-word {
        @include typo.typography('b3r', $color: map.get(color.$text-colors, 'default'));
        @include mx.ellipsis-single;
      }

      &-btn {
        @include button.btn-reset;
        @include icon.ic-size(fn.rem(16));
        box-sizing: content-box;
        flex-shrink: 0;
        padding: map.get(var.$unit, 4);
        margin: -#{map.get(var.$unit, 4)};
        color: map.get(color.$icon-neutral, 'primary');
        transition: transform 0.4s;
      }

      &-list {
        list-style: none;
      }

      &-item-link {
        @include mx.flex(flex, row, flex-start, center);
        gap: map.get(var.$unit, 4);
        height: fn.rem(34);
        padding: map.get(var.$unit, 8) map.get(var.$unit, 4);
        background: color.$color-white;
        border-radius: map.get(var.$radius, 'md');
        transition: background 0.5s;

        [class*='header-rank-'] {
          &[class*='-num'] {
            flex-shrink: 0;
            width: map.get(var.$unit, 16);
            text-align: right;
          }

          &[class*='move'] {
            box-sizing: content-box;
            flex-shrink: 0;
            padding: 0 fn.rem(6) 0 fn.rem(1);
            margin-left: auto;

            &[class*='rank-move-'] {
              display: block;
              width: fn.rem(7);
              height: fn.rem(6);
            }

            &.rank-move-up {
              @include mx.background('ic/rank-up.svg', transparent);
            }

            &.rank-move-down {
              @include mx.background('ic/rank-down.svg', transparent);
            }

            &.rank-move-same {
              @include mx.background('ic/rank-same.svg', transparent);
            }
          }
        }

        @include mx.common-mouse-event {
          background: map.get(color.$layout-surf, 'mypage');
        }
      }

      &-panel {
        @include mx.position(absolute, (map.get(var.$unit, 4) * -1), -30px);
        @include mx.flex(flex, column);
        @include mx.border('all', $color: map.get(color.$layout-border, 'secondary'));
        z-index: var.$zindex-header-rank;
        gap: map.get(var.$unit, 8);
        width: fn.rem(280);
        padding: map.get(var.$unit, 20) map.get(var.$unit, 16);
        clip-path: none !important;
        background: map.get(color.$layout-surf, 'base');
        border-radius: map.get(var.$radius, 'lg');
        box-shadow: map.get(var.$box-shadow, 'elevation_2');

        &-head {
          @include mx.flex(flex, row, space-between, center);
        }

        &-title {
          @include typo.typography('b2b', $color: map.get(color.$text-colors, 'secondary'));
        }

        &-close {
          @include button.btn-reset;
          @include icon.ic-size(map.get(var.$unit, 24));
        }

        &:not(.is-open) {
          max-height: 0;
        }
      }
    }

    .header-main {
      &-logo {
        display: block;
        width: fn.rem(144);
      }

      &-search {
        @include mx.flex(flex, row, center, center);
        gap: map.get(var.$unit, 20);

        &-rank {
          position: relative;
          width: fn.rem(140);

          &:has(.header-rank-panel.is-open) {
            .header-rank-btn {
              transform: rotate(180deg);
            }
          }
        }

        &-form {
          position: relative;
        }
      }

      &-util {
        @include mx.flex;
        gap: map.get(var.$unit, 24);

        .vits-btn-vertical-icon .badge {
          right: unset;
          left: map.get(var.$unit, 20);
          width: auto;
          min-width: fn.rem(15);
          padding: 0 map.get(var.$unit, 4);
        }
      }
    }

    .header-search {
      position: relative;

      &-input {
        @include mx.flex(flex, row, space-between, center);
        @include mx.border('all', $width: 2px, $color: map.get(color.$layout-border, 'primary'));
        gap: map.get(var.$unit, 8);
        width: $header-search-input;
        height: fn.rem(40);
        padding: 0 fn.rem(17) 0 map.get(var.$unit, 20);
        background: color.$color-white;
        border-radius: map.get(var.$radius, 'sm');
      }

      &-field {
        @include typo.typography('b3r');
        flex: 1 1 auto;
        min-width: 0;
        height: 100%;
        appearance: none;
        background: transparent;
        border: 0;
        outline: none;

        &::-webkit-search-cancel-button,
        &::-webkit-search-decoration,
        &::-webkit-search-results-button,
        &::-webkit-search-results-decoration {
          display: none;
          appearance: none;
        }

        &::-ms-clear,
        &::-ms-reveal {
          display: none;
          width: 0;
          height: 0;
        }
      }

      &-clear {
        @include button.btn-reset;
        @include mx.flex(flex, row, center, center);
        @include icon.ic-size(fn.rem(18));
        display: none;
        flex-shrink: 0;
        color: map.get(color.$icon-neutral, 'inverse');
        background: #797979;
        border-radius: fn.rem(18);
        transition: color 0.2s;

        &.is-visible {
          display: flex;
        }
      }

      &-submit {
        @include button.btn-reset;
        @include icon.ic-size(map.get(var.$unit, 24));
        flex-shrink: 0;
        color: map.get(color.$icon-neutral, 'primary');
      }

      &-panel {
        @include mx.position(absolute, 100%, $left: 0);
        @include mx.border('all', $color: map.get(color.$layout-border, 'secondary'));
        z-index: var.$zindex-header-search;
        display: none;
        width: $header-search-panel;
        padding: map.get(var.$unit, 32);
        margin-top: map.get(var.$unit, 4);
        background: color.$color-white;
        border-radius: map.get(var.$radius, 'lg');
        box-shadow: map.get(var.$box-shadow, 'elevation_1');

        &.is-open {
          display: block;
        }
      }
    }

    .search-panel {
      &-wrap {
        @include mx.flex;
        position: relative;
        height: 100%;
      }

      &-left {
        flex: 0 0 100%;
        width: 100%;
        height: 100%;
      }

      // 우측 상품 패널
      &-right {
        @include mx.flex(flex, column);
        position: absolute;
        top: 0;
        left: calc(#{$header-search-width} - 55px);
        z-index: var.$zindex-base;
        display: none;
        gap: map.get(var.$unit, 16);
        width: fn.rem(456);
        height: fn.rem(550);
        padding: map.get(var.$unit, 32);
        background: color.$color-white;
        border-radius: map.get(var.$radius, 'lg');
        box-shadow: inset 0 0 0 1px map.get(color.$layout-border, 'secondary');

        &.is-active {
          display: flex;
        }
      }
    }

    .search-recent {
      @include mx.flex(flex, column);
      gap: map.get(var.$unit, 16);

      &-head {
        @include mx.flex(flex, row, space-between, flex-start);
      }

      &-title {
        @include typo.typography('b2b', $color: map.get(color.$text-colors, 'secondary'));
      }

      &-clear {
        @include button.btn-reset;
        @include typo.typography('d2r', $color: map.get(color.$text-colors, 'tertiary'));

        &:hover,
        &:focus {
          color: map.get(color.$text-colors, 'primary');
          text-decoration: underline;
        }

        &.is-hidden {
          display: none;
        }
      }

      // 최근 검색어 목록 (태그 형태, 최대 2줄)
      &-list {
        @include mx.flex(flex, row, flex-start, flex-start, wrap);
        gap: map.get(var.$unit, 8);

        > li {
          flex: 0 0 auto;
          max-width: 100%;
        }
      }

      &-item {
        @include mx.flex(inline-flex, row, flex-start, center);
        flex-shrink: 0;
        gap: map.get(var.$unit, 2);
        max-width: 100%;
        min-height: map.get(var.$unit, 32);
        padding: map.get(var.$unit, 4) map.get(var.$unit, 8) map.get(var.$unit, 4) map.get(var.$unit, 12);
        background: color.$color-white;
        border-radius: map.get(var.$unit, 32);
        box-shadow: inset 0 0 0 1px map.get(color.$layout-border, 'tertiary');
      }

      &-link {
        @include typo.typography('b3s', $color: map.get(color.$text-colors, 'secondary'));
        display: block;
        min-width: 0;
        max-height: 2.6em; // line-height 1.3 × 2줄
        overflow: hidden;
      }

      &-del {
        @include button.btn-reset;
        @include mx.flex(flex, row, center, center);
        @include icon.ic-size(map.get(var.$unit, 24));
        flex-shrink: 0;
        color: map.get(color.$icon-neutral, 'primary');
      }
    }

    .search-related {
      @include mx.flex(flex, column);
      @include mx.border('top', $color: map.get(color.$layout-surf, 'sunken'));
      gap: map.get(var.$unit, 16);
      padding-top: map.get(var.$unit, 16);
      margin-top: map.get(var.$unit, 16);

      &-title {
        @include typo.typography('b3s', $color: map.get(color.$text-colors, 'tertiary'));
      }

      &-item {
        @include mx.flex(flex, column, flex-start, flex-start);
        gap: map.get(var.$unit, 4);
        padding: map.get(var.$unit, 8) map.get(var.$unit, 12);
        border-radius: map.get(var.$radius, 'md');
        transition: background-color 0.2s;

        span em {
          font-style: normal;
          color: map.get(color.$text-status, 'info-sub');
        }

        // 카테고리만 보여질 때
        &:not(:has(.search-related-text)) {
          .search-related-category {
            @include typo.typography('b3r');

            em {
              font-weight: 600;
            }

            .search-category {
              &:not(:only-of-type, :last-of-type) {
                &::after {
                  color: map.get(color.$text-colors, 'default');
                }
              }
            }
          }
        }

        @include mx.common-mouse-event {
          background: map.get(color.$layout-surf, 'mypage');
        }
      }

      &-list > li {
        &.is-active {
          .search-related-item {
            background: map.get(color.$layout-surf, 'mypage');
          }
        }
      }

      &-text {
        @include typo.typography('b3b');
      }

      &-category {
        @include mx.flex(flex, row, flex-start, center, wrap);
        @include typo.typography('b4r', $color: map.get(color.$text-colors, 'tertiary'));
        gap: map.get(var.$unit, 4);

        .search-category {
          @include mx.flex(flex, row, flex-start, center, wrap);
          gap: map.get(var.$unit, 4);

          &:not(:only-of-type, :last-of-type) {
            /* stylelint-disable-next-line no-descending-specificity */
            &::after {
              display: block;
              width: map.get(var.$unit, 12);
              height: map.get(var.$unit, 12);
              color: map.get(color.$icon-neutral, 'tertiary');
              content: '';
              background-color: currentcolor;
              mask: url('/public/resources/img/mro/renewal/ic/ic-arrow-right.svg') no-repeat center / contain;
            }
          }
        }
      }
    }

    .search-products {
      &-title {
        @include typo.typography('b2b', $color: map.get(color.$text-colors, 'secondary'));
        flex-shrink: 0;
      }

      &-panel {
        display: none;
        flex-grow: 1;
        min-width: 0;
        min-height: 0;
        overflow-y: auto;

        &.is-active {
          display: block;
        }
      }

      &-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: map.get(var.$unit, 20) map.get(var.$unit, 16);
      }
    }

    .search-product {
      &-card {
        /* stylelint-disable-next-line no-descending-specificity */
        a {
          @include mx.flex(flex, column);
          gap: map.get(var.$unit, 8);
        }

        .product {
          &-body {
            @include mx.flex(flex, column);
            gap: map.get(var.$unit, 8);
          }

          &-thumb {
            @include mx.common-list-thumb;
            width: 100%;
            aspect-ratio: 1 / 1;
            overflow: hidden;
            border-radius: map.get(var.$radius, 'lg');
          }

          &-summary {
            @include mx.flex(flex, column);
            gap: map.get(var.$unit, 2);
          }

          &-brand {
            @include typo.typography('b5r');
            padding-left: fn.rem(1.5);
          }

          &-name {
            @include typo.typography('b4s', $color: map.get(color.$text-colors, 'primary'));
            @include mx.ellipsis-multi(1.3, 2);
          }

          &-spec {
            @include typo.typography('b4r', $color: map.get(color.$text-colors, 'secondary'));
          }

          /* stylelint-disable-next-line no-descending-specificity */
          &-extra {
            @include mx.flex(flex, row, flex-start, flex-start, wrap);
            gap: fn.rem(3.2);
          }
        }
      }
    }
  }

  &-gnb {
    @include header-common-relative;

    .gnb {
      &-bar {
        @include mx.flex(flex, row, flex-start, flex-start);
        gap: 0 map.get(var.$unit, 32);
      }

      &-link {
        @include mx.flex(flex, row, flex-start, center);
        @include typo.typography('b2s');
        flex-shrink: 0;
        height: var.$header-gnb-height;
        padding: 0 map.get(var.$unit, 24);
      }

      &-nav {
        @include mx.flex(flex, row, flex-start, flex-start);
        flex-grow: 1;
        min-width: 0;
        max-height: var.$header-gnb-height;
        overflow: hidden;

        &-list {
          @include mx.flex(flex, row, flex-start, flex-start);
          position: relative;
          width: 100%;
          min-width: 0;

          &:has(.gnb-more-box.is-active) {
            .gnb-item-promo {
              margin-left: map.get(var.$unit, 32);
            }
          }
        }

        &.is-expanded {
          max-height: var.$header-gnb-full-height;
          overflow: hidden auto;

          .gnb-link {
            @include mx.ellipsis-single;
            display: inline-flex;
            max-width: 100%;

            &:has(.exhibition-item-sub) {
              flex-direction: column;
              align-items: flex-start;
              justify-content: center;

              .exhibition-item {
                &-sub {
                  @include typo.typography('h4s');
                  font-style: normal;
                }

                &-text {
                  @include typo.typography('b2r', $color: map.get(color.$text-colors, 'quaternary'));
                }
              }
            }
          }
        }
      }

      &-item {
        &:not(.gnb-item-promo-list) {
          flex: 0 0 auto;
        }

        &.gnb-item-home,
        &.gnb-item-deal {
          margin-right: map.get(var.$unit, 12);
        }

        &.gnb-item-promo {
          margin-left: map.get(var.$unit, 12);

          .gnb-link {
            padding-right: 0;
          }
        }

        &.gnb-item-promo-list {
          @include mx.flex(flex, row, flex-start, stretch);
          position: relative;
          flex: 0 1 auto;
          min-width: 0;

          .gnb-promo-list {
            @include mx.flex;
            flex: 0 1 auto;
            gap: map.get(var.$unit, 12);
            min-width: 0;
            max-width: fn.rem(710);
            overflow: hidden;

            .gnb-link.is-hidden {
              display: none;
            }
          }

          &:has(.gnb-more-box.is-active) {
            &::after {
              @include mx.position(absolute, calc((var.$header-gnb-height - $header-gnb-more-height) / 2), 0);
              z-index: var.$zindex-base;
              width: 1px;
              height: $header-gnb-more-height;
              pointer-events: none;
              content: '';
              background: map.get(color.$layout-border, 'quinary');
            }
          }
        }
      }

      &-fixed-list {
        @include mx.flex;
        flex-shrink: 0;
        max-width: max-content;
      }

      &-left {
        @include mx.flex(flex, row, flex-start, center);
        flex-shrink: 0;
        gap: map.get(var.$unit, 32);
      }

      &-btn {
        @include button.btn-reset;
        @include mx.flex(flex, row, center, center);
        gap: map.get(var.$unit, 4);
        height: var.$header-gnb-height;

        .icon {
          @include icon.ic-size(fn.rem(24));
          color: map.get(color.$icon-neutral, 'primary');
          transition: transform 0.3s;
          will-change: transform;
        }

        .text {
          @include typo.typography('h4s', $color: map.get(color.$neutral-colors, '1'));
        }

        &.category .icon.left {
          @include icon.ic-size(fn.rem(28));
        }

        &[aria-expanded='true'] {
          @include gnb-btn-active-style;

          .icon.right {
            transform: rotate(180deg);
          }
        }

        @include mx.common-mouse-event {
          @include gnb-btn-active-style;
        }
      }

      &-more {
        @include button.btn-reset;
        position: relative;
        z-index: var.$zindex-base + 2;
        margin-right: fn.rem(9);

        .icon {
          @include icon.ic-size($header-gnb-more-height);
          display: block;
          padding: map.get(var.$unit, 2);
          color: map.get(color.$icon-neutral, 'tertiary');
          transition: transform 0.3s;
          will-change: transform;
        }

        @mixin more-active-style {
          .icon {
            color: map.get(color.$brand-colors, 'primary');
            transform: rotate(45deg * 3);
          }
        }

        &[aria-expanded='true'] {
          @include more-active-style;
        }

        @include mx.common-mouse-event {
          @include more-active-style;
        }

        &-box {
          @include mx.position(absolute, calc((var.$header-gnb-height - fn.rem(28)) / 2), 0);
          z-index: var.$zindex-base;
          display: none;
          background: color.$color-white;

          &::before {
            @include mx.position(absolute, 0, fn.rem(37));
            z-index: var.$zindex-base;
            width: fn.rem(116);
            height: 100%;
            pointer-events: none;
            content: '';
            background: linear-gradient(to right, rgb(255 255 255 / 0%), rgb(255 255 255 / 100%));
          }

          &::after {
            @include mx.position(absolute, 0, 9px);
            width: $header-gnb-more-height;
            height: $header-gnb-more-height;
            content: '';
            background: map.get(color.$layout-surf, 'base');
            border-radius: map.get(var.$radius, 'sm');
            box-shadow: inset 0 0 0 1px map.get(color.$layout-border, 'quaternary');
            transition: box-shadow 0.2s;
          }

          &:has(.gnb-more:hover),
          &:has(.gnb-more[aria-expanded='true']) {
            &::after {
              box-shadow: inset 0 0 0 1px map.get(color.$brand-colors, 'primary');
            }
          }

          &.is-active {
            display: flex;
          }
        }
      }

      &-panel {
        @include mx.position(absolute, 100%, $left: 0);
        @include mx.border('top', $color: map.get(color.$layout-border, 'quaternary'));
        @include mx.border;
        z-index: var.$zindex-header-panel;
        width: 100%;
        background: color.$color-white;

        &.is-open {
          max-height: var.$header-panel-height-max;
        }

        &.gnb-panel-more {
          position: static;
          border-bottom: 0;

          .gnb-panel {
            &-inner {
              background: map.get(color.$layout-surf, 'raised');
            }

            &-body {
              @include mx.flex(flex, column);
              max-height: 50vh;
              padding: 0 0 map.get(var.$unit, 36);
              overflow-y: auto;

              &-title {
                @include typo.typography('b2s', $color: map.get(color.$text-colors, 'secondary'));
                position: sticky;
                top: 0;
                z-index: var.$zindex-base;
                width: 100%;
                padding: map.get(var.$unit, 24) 0;
                background: linear-gradient(
                  180deg,
                  rgb(250 250 250 / 100%) 0%,
                  rgb(250 250 250 / 100%) 70%,
                  rgb(250 250 250 / 0%) 100%
                );
              }
            }

            &-list {
              display: grid;
              grid-template-columns: repeat(auto-fill, minmax(fn.rem(200), 1fr));
              gap: map.get(var.$unit, 16);

              &:not(:has(> li:nth-child(6))) {
                grid-template-columns: repeat(auto-fill, fn.rem(200));
              }
            }
          }

          &[data-toggle-box].is-open {
            overflow: hidden;
          }
        }
      }

      &-panel-category {
        &.is-open {
          max-height: 100vh;
          overflow: hidden;
        }

        .gnb-category {
          @include mx.flex(flex, row, flex-start, stretch);
          height: fn.rem(690);

          &-col {
            overflow: hidden auto;

            &:not(:last-of-type) {
              @include mx.border('right', $color: map.get(color.$layout-border, 'quaternary'));
            }
          }

          &-col:not(.gnb-category-col-4) {
            flex: 0 0 fn.rem(220);
          }

          &-link {
            @include mx.flex(flex, row, flex-start, center);
            position: relative;
            display: block;
            min-height: map.get(var.$unit, 40);
            padding: fn.rem(10) 0 fn.rem(10) map.get(var.$unit, 16);
            overflow: hidden;

            .text {
              @include typo.typography('b3r');
            }

            .icon {
              @include mx.position(absolute, 50%, fn.rem(6));
              @include icon.ic-size(fn.rem(18));
              flex-shrink: 0;
              color: map.get(color.$icon-status, 'info');
              opacity: 0;
              transition:
                transform 0.35s ease,
                opacity 0.25s ease;
              transform: translate(100%, -50%);
            }

            @include mx.common-mouse-event {
              @include gnb-category-link;
            }
          }

          .gnb-category-col-4 {
            flex: 1 1 auto;
            min-width: 0;
            padding-left: fn.rem(58);
          }

          .gnb-reco {
            @include mx.flex(flex, column);
            gap: map.get(var.$unit, 20);
            padding: map.get(var.$unit, 32) 0;

            &-title {
              &-point {
                @include typo.typography('b2b', $color: map.get(color.$text-status, 'brand'));
              }

              &-text {
                @include typo.typography('b2b', $color: map.get(color.$text-status, 'secondary'));
              }
            }

            &-list {
              @include mx.flex(flex, row, flex-start, stretch);
              gap: map.get(var.$unit, 20);
            }

            &-item {
              flex-shrink: 0;
              width: fn.rem(168);
            }
          }

          &-item.is-current > .gnb-category-link {
            @include gnb-category-link;
          }

          .gnb-category-col-2,
          .gnb-category-col-2 .gnb-category-box,
          .gnb-category-col-3,
          .gnb-category-col-3 .gnb-category-box,
          .gnb-category-col-3 .gnb-category-box:not(:has(.gnb-category-list-3 li)) {
            display: none;
          }

          .gnb-category-col-2 .gnb-category-box.is-active,
          .gnb-category-col-3 .gnb-category-box.is-active,
          &.is-col2-open .gnb-category-col-2,
          &.is-col3-open .gnb-category-col-3 {
            display: block;
          }

          &.is-col2-open .gnb-category-col-1 .gnb-category-item.is-active .gnb-category-link,
          &.is-col3-open .gnb-category-col-2 .gnb-category-item.is-active .gnb-category-link {
            padding-right: map.get(var.$unit, 24);

            .icon {
              opacity: 1;
              transform: translate(0, -50%);
            }
          }
        }
      }
    }

    &.is-more-visible {
      .gnb-more-box {
        display: block;
      }
    }
  }

  .gnb-dim {
    @include mx.position(fixed, 0, 0, 0, 0);
    z-index: var.$zindex-base;
    display: none;
    background: color.$color-dim;

    &[aria-hidden='false'] {
      display: block;
    }
  }
}

/* HEADER GNB 추천 상품 아이템 */
.gnb-reco-item {
  &[data-member='true'] {
    .product-price-alt.is-guest {
      display: none !important;
    }
  }

  &[data-member='false'] {
    .product-extra,
    .vits-price-box.is-normal,
    .product-price-alt.is-soldout,
    .product-actions {
      display: none !important;
    }
  }

  &[data-stock='true'] {
    .product-price-alt.is-soldout {
      display: none !important;
    }
  }

  &[data-stock='false'] {
    .vits-price-box.is-normal {
      display: none !important;
    }
  }

  &-card {
    @include mx.flex(flex, column, flex-start, flex-start);
    gap: map.get(var.$unit, 8);

    .product {
      &-thumb {
        @include mx.common-list-thumb;
      }

      /* stylelint-disable-next-line no-descending-specificity */
      &-body {
        @include mx.flex(flex, column);
        gap: map.get(var.$unit, 8);
        width: 100%;
      }

      &-name {
        @include typo.typography('b3s', $color: map.get(color.$text-colors, 'primary'));
        @include mx.ellipsis-multi(1.3, 2);
      }

      &-price {
        .price-origin-label {
          @include typo.typography('d3r', $color: map.get(color.$text-colors, 'tertiary'));
          text-decoration: line-through;
        }

        .price-sale-row {
          @include mx.flex(flex, row, flex-start, center);
          gap: map.get(var.$unit, 4);

          .price-rate {
            @include typo.typography('b1b', $color: map.get(color.$text-status, 'brand'));
          }

          .price-sale {
            @include typo.typography('b1b', $color: map.get(color.$text-colors, 'primary'));
          }
        }

        .product-price-alt.is-soldout {
          @include typo.typography('b1b', $color: map.get(color.$label-shipping, 'today'));
        }

        .product-price-alt.is-guest {
          @include mx.flex(flex, column, flex-start, flex-start);
          gap: map.get(var.$unit, 12);

          .price-guest-text {
            @include mx.flex(flex, column, flex-start, flex-start);
            gap: map.get(var.$unit, 2);

            &-title {
              @include typo.typography('b4s', $color: map.get(color.$text-status, 'info-sub'));
            }

            &-desc {
              @include typo.typography('b4r', $color: map.get(color.$text-colors, 'secondary'));
            }
          }

          .price-guest-action {
            width: 100%;

            .price-login-button {
              @include button.btn-reset;
              @include mx.flex(flex, row, center, center);
              @include mx.border('all', $color: map.get(color.$layout-border, 'tertiary'));
              gap: fn.rem(10);
              width: 100%;
              height: map.get(var.$unit, 32);
              padding: 0 map.get(var.$unit, 8);
              border-radius: map.get(var.$radius, 'sm');

              /* stylelint-disable-next-line no-descending-specificity */
              .icon {
                @include icon.ic-size(map.get(var.$unit, 16));
                color: map.get(color.$icon-neutral, 'primary');
              }

              .text {
                @include typo.typography('b3r', $color: map.get(color.$text-colors, 'tertiary'));
              }
            }
          }
        }
      }
    }
  }
}
