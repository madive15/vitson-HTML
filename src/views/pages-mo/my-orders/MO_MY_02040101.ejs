<% const _src = srcPath; const _public = publicPath; %>
<!-- prettier-ignore -->
<%
  // 폴더 목록 mock 데이터
  const _folders = [
    {
      folderName: '총무관리 1팀 폴더',
      owner: '총무 관리 123팀',
      itemCount: 3,
      date: '2025-12-24'
    },
    {
      folderName: '일이삼사오육칠팔구십일이삼사오육칠팔구십일이삼사오육칠팔구신일이삼사오육칠팔구십일이삼사오육칠팔구십일이삼사오육칠팔구신',
      owner: '일이삼사오육칠팔구십일이삼사오육칠팔구십일이삼사오육칠팔구신일이삼사오육칠팔구십일이삼사오육칠팔구십일이삼사오육칠팔구신',
      itemCount: 3,
      date: '2025-12-24'
    },
    {
      folderName: '총무관리 1팀 폴더',
      owner: '총무 관리 123팀',
      itemCount: 3,
      date: '2025-12-24'
    },
    {
      folderName: '총무관리 1팀 폴더',
      owner: '총무 관리 123팀',
      itemCount: 3,
      date: '2025-12-24'
    }
  ];
%>

<!DOCTYPE html>
<html lang="ko" class="vm-scope">
  <%- include(`${_src}/views/layout-mo/header/head.ejs`, { meta_title: '좋아요 폴더목록' }) %>
  <body class="vm-scope">
    <a href="#skipNav" class="skip-nav">본문 바로가기</a>

    <section class="vm-wrapper">
      <div class="vm-wrap wrap-mypage">
        <div class="vm-content-wrap">
          <%- include(`${_src}/views/layout-mo/header/index.ejs`, { type: 'nav-bar', title: '총무관리 123팀 폴더',
          actions: [ { iconName: 'bell', href: '#!', label: '알림', active: true }, { iconName: 'bag', href: '#!',
          label: '장바구니' }, ], }) %>

          <main id="skipNav" class="vm-main">
            <div class="vm-main-content main-content-my-orders" data-checkbox-scope>
              <%- include(`${_src}/views/components-mo/product/product-list-toolbar.ejs`, { toolbarType: 'checkbox',
              listType: 'folder' }) %>

              <ul class="vm-product-list-folder">
                <% _folders.forEach((folder) => { %>
                <li>
                  <%- include(`${_src}/views/components-mo/form/checkbox-folder.ejs`, { folderName: folder.folderName,
                  owner: folder.owner, itemCount: folder.itemCount, date: folder.date }) %>
                </li>
                <% }); %>
              </ul>
            </div>
          </main>

          <%- include(`${_src}/views/layout-mo/footer/index.ejs`) %>
        </div>

        <%- include(`${_src}/views/layout-mo/bottom-bar/index.ejs`, { type: 'tab-bar', currentTab: 'mypage' }) %>
      </div>
    </section>

    <%- include(`${_src}/views/layout/footer.links.ejs`) %>

    <script>
      (function ($) {
        var $scope = $('[data-checkbox-scope]');
        var $countArea = $scope.find('.toolbar-item.is-hidden');
        var $buttons = $scope.find('.toolbar-actions button');
        var $deleteBtn = $scope.find('[data-toolbar-delete]');
        var $qtyDisplay = $scope.find('[data-checkbox-all]').closest('label').find('.label-unit');

        // 선택 개수 변경 시 UI 업데이트
        $scope.on('checkbox-change', function (e, count) {
          $qtyDisplay.text('(' + count + ')');

          if (count > 0) {
            $countArea.removeClass('is-hidden');
            $deleteBtn.prop('disabled', false);
          } else {
            $countArea.addClass('is-hidden');
            $deleteBtn.prop('disabled', true);
          }
        });

        // 폴더 삭제
        $deleteBtn.on('click', function () {
          var $checkedItems = $scope.find('[data-checkbox-item]:checked');
          $checkedItems.closest('li').remove();
          alert('삭제되었습니다.');
          $scope.trigger('checkbox-change', [0]);
        });
      })(window.jQuery || window.$);

      (function ($) {
        var ATTR = 'data-vits-toolbar';
        var $toolbar = $('[' + ATTR + ']');
        if (!$toolbar.length) return;

        function setStickyTop() {
          var $header = $('[data-vits-header]');
          if (!$header.length) return;

          // sticky header는 항상 뷰포트 상단에 붙어있으므로 height가 곧 sticky top
          var stickyTop = $header[0].getBoundingClientRect().height;

          $toolbar.css({
            position: 'sticky',
            top: stickyTop + 'px',
            zIndex: 10
          });
        }

        // 폰트·이미지 로드 완료 후 정확한 높이 계산
        $(window).on('load', setStickyTop);
      })(window.jQuery || window.$);
    </script>
  </body>
</html>
