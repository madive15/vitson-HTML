<% const _src = srcPath; const _public = publicPath; %>
<!-- prettier-ignore -->

<!DOCTYPE html>
<html lang="ko" class="vm-scope">
  <%- include(`${_src}/views/layout-mo/header/head.ejs`, {meta_title: '취소신청'}) %>
  <body class="vm-scope">
    <!-- S: Skip Navigation -->
    <a href="#skipNav" class="skip-nav">본문 바로가기</a>
    <!-- E: Skip Navigation -->

    <!-- S: vm-wrapper -->
    <section class="vm-wrapper">
      <!-- S: vm-wrap -->
      <!-- vm-wrap => data-step scope 부여 -->
      <!-- prettier-ignore -->
      <div class="vm-wrap wrap-my-orders"
        data-step="1" 
        data-step-done="취소신청 완료"
      >
        <!-- S: vm-content-wrap -->
        <div class="vm-content-wrap">
          <!-- prettier-ignore -->
          <%- include(`${_src}/views/layout-mo/header/index.ejs`, { 
            type: 'nav-bar-step', 
            title: '취소신청',
            steps: [
              { label: '상품선택' },
              { label: '환불방법' }
            ]
          }) %>

          <!-- S: vm-main -->
          <main id="skipNav" class="vm-main">
            <!-- [D] data-scroll-auto-hidden => 스크롤 시, 셀렉트박스 자동 닫힘. -->
            <div class="vm-main-content main-content-my-orders status-cancel" data-scroll-auto-hidden>
              <!-- step 1 -->
              <%- include(`${_src}/views/components-mo/mypage/claim-request-step1.ejs`, { claimType: 'cancel' }) %>
              
              <!-- step 2 -->
              <%- include(`${_src}/views/components-mo/mypage/claim-request-step2-cancel.ejs`) %>
            
            </div>
          </main>
          <!-- E: vm-main -->

          <%- include(`${_src}/views/layout-mo/footer/index.ejs`) %>
        </div>
        <!-- E: vm-content-wrap -->

        <!-- S: vm-bottom-group -->
        <!-- prettier-ignore -->
        <%- include(`${_src}/views/layout-mo/bottom-bar/index.ejs`, { 
          type: 'step-bar', currentTab: 'mypage' 
        }) %>
        <!-- E: vm-bottom-group -->

        <!-- S: 팝업 영역 -->
        <!-- E: 팝업 영역 -->
      </div>
      <!-- E: vm-wrap -->
    </section>
    <!-- E: vm-wrapper -->

    <%- include(`${_src}/views/layout/footer.links.ejs`) %>

    <!-- [REMOVE] 퍼블 확인용 임시 코드 - 개발 적용 시 제거 -->
    <script>
      (function () {
        'use strict';

        var params = new URLSearchParams(window.location.search);
        var type = params.get('type') || 'multi';
        var root = document.querySelector('[data-step]');
        if (!root) return;

        var startStep = params.get('step');
        if (startStep) {
          root.setAttribute('data-step', startStep);
        }

        // ?type=single / ?type=multi 분기
        root.querySelectorAll('[data-claim]').forEach(function (el) {
          el.style.display = el.dataset.claim === type ? '' : 'none';
        });

        // multi일 때만: 체크박스 ↔ 버튼 활성화
        if (type === 'multi') {
          var ITEM_CB = '.card-checkbox input[type="checkbox"]';
          var ACTION = '[data-step-action]';

          function updateAction() {
            var checked = root.querySelectorAll(ITEM_CB + ':checked').length;
            var btn = root.querySelector(ACTION);
            if (!btn) return;
            btn.classList.toggle('is-disabled', checked === 0);
            btn.disabled = checked === 0;
          }

          updateAction();

          root.addEventListener('change', function (e) {
            if (!e.target.matches('input[type="checkbox"]')) return;
            updateAction();
          });
        }
      })();
    </script>
  </body>
</html>
